const ReportModel = require('./src/models/ReportModel');

async function testReportModel() {
  try {
    console.log('üîß Testing ReportModel directly\n');

    const reportModel = new ReportModel();
    
    // Test the generateMonthlyContentReport method
    const options = {
      month: '2024-09',
      start_date: '2024-09-01T00:00:00.000Z',
      end_date: '2024-09-30T23:59:59.999Z',
      fields: ['Announcements', 'SchoolCalendar'],
      generated_by: 'Test Admin'
    };

    console.log('üì§ Calling generateMonthlyContentReport with options:');
    console.log(JSON.stringify(options, null, 2));

    const reportData = await reportModel.generateMonthlyContentReport(options);

    console.log('\nüì• Report generated successfully!');
    console.log('Report structure:', Object.keys(reportData));
    
    if (reportData.report) {
      const report = reportData.report;
      console.log('\nüìä Report Details:');
      console.log('Title:', report.title);
      console.log('Description:', report.description);
      console.log('Generated At:', report.meta.generatedAt);
      console.log('Generated By:', report.meta.generatedBy);
      
      console.log('\nüìà Tallies:');
      console.log('Announcements:', report.tallies.announcements);
      console.log('School Calendar:', report.tallies.school_calendar);
      
      console.log('\nüìù Items:');
      console.log(`Total items: ${report.items.length}`);
      
      if (report.items.length > 0) {
        console.log('First few items:');
        report.items.slice(0, 5).forEach((item, index) => {
          console.log(`${index + 1}. ${item.title}`);
          console.log(`   Type: ${item.type}`);
          console.log(`   Category: ${item.category}`);
          console.log(`   Date: ${item.date}`);
          console.log(`   Images: ${item.images.length}`);
          console.log('');
        });
      } else {
        console.log('‚ö†Ô∏è  No items found in report!');
      }
    }

  } catch (error) {
    console.error('‚ùå Error testing ReportModel:', error.message);
    console.error(error.stack);
  }
}

testReportModel();
